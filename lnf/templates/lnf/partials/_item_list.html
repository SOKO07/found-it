{% if view_type == 'list' %}
<div class="list-header">
    <div>Name</div>
    <div>Category</div>
    <div>Found Date</div>
    <div>Found Location</div>
    <div>Status</div>
    <div>Action</div>
</div>
{% endif %}
{% if item_list %}
    {% for item in item_list %}
        <div class="item {% if item.is_held_by_user %}is-watched{% endif %}">
            {% if view_type == 'list' %}
                <div>
                    <strong>{{ item.name }}</strong>
                </div>
                <div>
                    {% if item.category %}{{ item.category }}{% else %}{{ item.pending_category_name }} (pending){% endif %}
                </div>
                <div>{{ item.found_date }}</div>
                <div>{{ item.found_location }}</div>
                <div>{{ item.get_status_display }}</div>
            {% else %} {# Grid view structure #}
                {% if item.image and request.user == item.uploaded_by %}
                    <img src="{{ item.image.url }}" alt="{{ item.name }}" style="max-width: 100%; height: auto; margin-bottom: 10px;">
                {% endif %}
                <h4>{{ item.name }}</h4>
                <p>
                    <strong>Category:</strong> {% if item.category %}{{ item.category }}{% else %}{{ item.pending_category_name }} (pending){% endif %}<br>
                    <strong>Found on:</strong> {{ item.found_date }}<br>
                    <strong>Found at:</strong> {{ item.found_location }}<br>
                    <strong>Status:</strong> {{ item.get_status_display }}
                </p>
            {% endif %}
            <div class="item-actions">
                {% if request.user == item.uploaded_by %}
                    {% if show_delete_button %}
                        {% if item.status != 'retrieved' %}
                            <form action="{% url 'lnf:delete_item' item.id %}" method="post" style="display: inline;" class="delete-item-form">
                                {% csrf_token %}
                                <button type="submit" class="hold-button" title="Delete Item" onclick="return confirm('Are you sure you want to delete this item?');"><i class="fa-solid fa-trash"></i></button>
                            </form>
                        {% endif %}
                    {% else %}
                        <form action="{% url 'lnf:go_to_my_uploads' %}" method="post" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="hold-button" title="My Uploads"><i class="fa-solid fa-box-archive"></i></button>
                        </form>
                    {% endif %}
                {% else %}
                    {% if item.status != 'retrieved' %}
                        <button type="button" class="toggle-watch-btn {% if request.user in item.held_by.all %}unhold-button{% else %}hold-button{% endif %}" data-item-id="{{ item.id }}" data-toggle-url="{% url 'lnf:toggle_watch_item' item.id %}" title="{% if request.user in item.held_by.all %}Unwatch Item{% else %}Watch Item{% endif %}">
                            <i class="fa-solid fa-eye"></i>
                        </button>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    {% endfor %}
{% else %}
    <p>No items match your search criteria. Please try again.</p>
{% endif %}
